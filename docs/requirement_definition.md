# サブスクリプション管理アプリ要件定義書

## 1. 課題分析と解決アプローチ

### 1.1 主要課題と解決方針

1. サブスク料金の見落とし
    * プッシュ通知による事前アラート
    * カレンダー表示での視覚化
    * 支払い日が近いサブスクの優先表示

2. 総額の把握が困難
    * ダッシュボードでの月額・年額総計の即時表示
    * カテゴリ別支出のグラフ化

## 2. 機能要件

### 2.1 基本機能

* ユーザー管理
    * メールアドレスによる会員登録・ログイン
    * ゲストモード利用オプション
    * アカウント設定（通知設定等）

* カテゴリ管理
    * カテゴリの作成・編集・削除
    * カテゴリ名
    * カテゴリの並び替え

* サブスクリプション情報管理
    * 登録・編集・削除機能
    * サービス名、金額、支払日、サイクル
    * カテゴリの選択（必須）
    * メモ機能
    * 画像管理機能
        * アップロード方法
            * カメラ撮影
            * フォトライブラリから選択
        * 画像処理
            * アップロード前の自動リサイズ処理（200KB以下）
        * 保存管理
            * クラウド保存：AWS S3
            * ローカル保存：iOSデバイスストレージ
        * 同期処理
            * バックグラウンドでの自動同期
            * オフライン時のローカルデータ表示
            * インターネット接続時の自動更新

### 2.2 表示機能

* ダッシュボード
    * 月間・年間総額表示
    * カテゴリ別支出円グラフ
    * カテゴリ別支出一覧

* サブスク一覧表示
    * カテゴリ別表示
    * 金額順表示
    * 支払日順表示

### 2.3 分析・予測機能

* 利用状況分析
    * カテゴリ別支出分析
    * 月次変動分析
    * 年間予測

### 2.4 通知機能

* 支払い関連通知
    * 支払い前日通知
    * 支払い完了確認

### 2.5 データ同期の仕様

1. アプリ起動時
    * ローカルデータの即時表示
    * バックグラウンドで最新データチェック
    * 更新がある場合は自動ダウンロード

2. 新規データ追加時
    * ローカル保存と同時にクラウドへアップロード
    * 通信エラー時はローカルにキューイング

3. オフライン時
    * ローカルデータでの動作継続
    * 接続復旧時に自動同期実行

### 2.6 機能制限（ゲストモード）

* 利用可能機能
    * 基本的なサブスク管理
    * ダッシュボード表示
    * カテゴリ管理
    * 分析機能

* 制限される機能
    * データのバックアップ・復元
    * 端末間同期
    * プッシュ通知

## 認証/認可

- Amazon Cognito使用
- ユーザー情報はCognitoとDynamoDBの両方で管理

## アイコン管理

- ユーザー端末のローカルストレージに保存
- DynamoDBにはローカルパスのみ保存
- アプリ再インストールや端末変更時は再設定が必要
- サブスク削除時は関連するローカルアイコンも削除

## 通貨管理

- ユーザー作成時に国を選択
- 選択した国の通貨がデフォルトで設定
- 為替レート変換機能なし（コスト削減）

## UI/UX考慮点

- アイコン設定時にローカル保存である旨を表示
- 新規端末やアプリ再インストール時にアイコン再設定の案内を表示
- アイコン画像は適切なサイズにリサイズして保存

## エラーハンドリング

- アイコン読み込みエラー時はデフォルトアイコンを表示
- ローカルストレージの容量警告表示
- アイコン削除失敗時もサブスク削除は完了させる